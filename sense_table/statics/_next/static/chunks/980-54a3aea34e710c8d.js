"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[980],{58243:function(n,e,t){t.d(e,{G7:function(){return a},HK:function(){return i},Je:function(){return s},Z6:function(){return r},fF:function(){return u},o$:function(){return o},vb:function(){return c},xW:function(){return l}});var r={FolderBrowser:"FolderBrowser",Table:"Table"},o=32,a={ColumnNavigation:"ColumnNavigation",MainTable:"MainTable",Histogram:"Histogram",BubblePlot:"BubblePlot",BoxPlot:"BoxPlot",HeatMap:"HeatMap",Gallery:"Gallery",ColumnFilters:"ColumnFilters",RowDetails:"RowDetails",DistributionSummary:"DistributionSummary",FreeFormSQL:"FreeFormSQL",BrowseFolder:"BrowseFolder",Playground:"Playground"},u="Three columns",c="Side by side",i="Two columns",s={TEXT:"Text",NUMBER:"Number",CATEGORY:"Category",JSON:"JSON",IFRAME:"IFrame",LINK:"Link",VIDEO_URL:"VideoUrl",IMAGE_URL:"ImageUrl"},l="https://smoosenseai.github.io/sense-table/"},20619:function(n,e,t){t.d(e,{Ch:function(){return l},Fj:function(){return s},Kb:function(){return u},OS:function(){return m},nU:function(){return d},oW:function(){return p},qv:function(){return c}});var r=t(98656),o=t(31032),a=t(37736),u=(0,r.oM)({name:"agColDefs",initialState:{columnDefs:[],sorting:[],filters:{},baselineFilters:{}},reducers:{setColumnDefs:function(n,e){n.columnDefs=e.payload},setSorting:function(n,e){n.sorting=e.payload},updateDef:function(n,e){var t=e.payload,r=t.field,o=t.name,a=t.value,u=n.columnDefs.find((function(n){return n.field===r}));u&&(u[o]=a)},setFilters:function(n,e){n.filters=e.payload},setFilterForColumn:function(n,e){var t=e.payload,r=t.field,o=t.filter;n.filters[r]=o},clearFilterForColumn:function(n,e){var t=e.payload.field;delete n.filters[t]},setBaselineFilters:function(n){n.baselineFilters=n.filters}}}),c=function(n){return(0,o.map)(n.getColumnDefs(),(function(n){return(0,o.pick)(n,["hide","pinned","field"])}))},i=function(n){n(a.Kf.actions.refreshAllData()),n(a.It.actions.setShouldRefresh())},s=function(n,e,t){n(b({field:e,filter:t})),i(n)},l=function(n,e){n(u.actions.clearFilterForColumn({field:e})),i(n)},f=u.actions,p=f.setColumnDefs,d=f.updateDef,m=(f.setFilters,f.setSorting),b=f.setFilterForColumn;f.clearFilterForColumn,f.setBaselineFilters},4456:function(n,e,t){t.d(e,{Z:function(){return l},n:function(){return f}});var r=t(69380),o=t(40679),a=t.n(o),u=t(37736),c=t(78356),i=t(5490),s=t(81476),l=(0,u.vQ)("boxPlot"),f=function(n){var e=n.boxPlotColumns;return function(){var n=(0,r.Z)(a().mark((function n(t,r){var o,f,p,d,m,b,h,v,y;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=r().boxPlot||u.E3,f=o.data,p=o.loading,d=o.shouldRefresh,m=r().settings.boxPlotBreakdownColumn,!f&&!p||d){n.next=4;break}return n.abrupt("return");case 4:return t(l.actions.fetchStart()),n.prev=5,b=function(n){var e=(0,s.q)(n);return"{\n        'min' : MIN(".concat(e,"),\n        'max' : MAX(").concat(e,"),\n        'std' : STDDEV_POP(").concat(e,"),\n        'skewness': SKEWNESS(").concat(e,"),\n        'avg' : AVG(").concat(e,"),\n        'q25' : QUANTILE_CONT(").concat(e,", 0.25),\n        'q50' : QUANTILE_CONT(").concat(e,", 0.5),\n        'q75' : QUANTILE_CONT(").concat(e,", 0.75)\n      } AS ").concat(e)},h=(0,c.kA)(r()),v="\n    WITH filtered AS (\n          SELECT ".concat((0,s.q)(m)," AS breakdown, \n          ").concat(e.map(s.q).join(", "),"\n          ").concat(h.from,"\n          ").concat(h.where,"\n      ) SELECT breakdown, COUNT(*) AS count, ").concat(e.map((function(n){return b(n)})).join(", "),"\n      FROM filtered\n      GROUP BY breakdown\n    "),n.next=11,(0,i.Vn)({dispatch:t,key:"boxPlot",query:v});case 11:y=n.sent,t(l.actions.fetchSuccess(y)),n.next=19;break;case 15:n.prev=15,n.t0=n.catch(5),console.error(n.t0),t(l.actions.fetchError(n.t0.message));case 19:case"end":return n.stop()}}),n,null,[[5,15]])})));return function(e,t){return n.apply(this,arguments)}}()}},94582:function(n,e,t){t.d(e,{B:function(){return p},X:function(){return f}});var r=t(67856),o=t(69380),a=t(40679),u=t.n(a),c=t(37736),i=t(78356),s=t(5490),l=t(81476),f=(0,c.vQ)("bubblePlot"),p=function(n){var e=n.bubblePlotXColumn,t=n.bubblePlotYColumn,a=n.xBin,p=n.yBin;return function(){var n=(0,o.Z)(u().mark((function n(o,d){var m,b,h,v,y,g,w,O,S;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(m=d().bubblePlot||c.E3,b=m.data,h=m.loading,v=m.shouldRefresh,y=d().settings.bubblePlotBreakdownColumn,!b&&!h||v){n.next=4;break}return n.abrupt("return");case 4:return o(f.actions.fetchStart()),n.prev=5,g=(0,i.kA)(d()),w="\n    WITH filtered AS (\n          SELECT \n            ".concat((0,l.q)(e)," AS x,\n            ").concat((0,l.q)(t)," AS y,\n            ").concat((0,l.q)(y)," AS breakdown\n          ").concat(g.from,"\n          ").concat(g.where," AND x IS NOT NULL AND y IS NOT NULL\n      ), binned AS (\n      SELECT\n          p.*,\n          FLOOR((p.x - ").concat(a.min,") / ").concat(a.step,")::INT AS bin_x,\n          FLOOR((p.y - ").concat(p.min,") / ").concat(p.step,")::INT AS bin_y\n      FROM filtered AS p\n      )\n      SELECT breakdown, bin_x, bin_y,\n      -- Compute the \u201cbubble\u201d center as the average x and y within that bin\n      AVG(x)            AS x,\n      AVG(y)            AS y,\n      COUNT(*)          AS count\n      FROM binned\n      GROUP BY 1, 2, 3\n    "),n.next=10,(0,s.Vn)({dispatch:o,key:"bubblePlot",query:w});case 10:O=n.sent,S=_(O).groupBy("breakdown").toPairs().map((function(n){var o=(0,r.Z)(n,2),u=o[0],c=o[1];return{name:u,x:_.map(c,"x"),y:_.map(c,"y"),customdata:_.map(c,(function(n){var r=n.bin_x*a.step+a.min,o=r+a.step,u=n.bin_y*p.step+p.min,c=u+p.step,i=(0,l.q)(e),s=(0,l.q)(t);return{condExpr:["".concat(i," >= ").concat(r),"".concat(i," < ").concat(o),"".concat(s," >= ").concat(u),"".concat(s," < ").concat(c)].join(" AND "),count:n.count}}))}})).value(),o(f.actions.fetchSuccess(S)),n.next=19;break;case 15:n.prev=15,n.t0=n.catch(5),console.error(n.t0),o(f.actions.fetchError(n.t0.message));case 19:case"end":return n.stop()}}),n,null,[[5,15]])})));return function(e,t){return n.apply(this,arguments)}}()}},75492:function(n,e,t){t.d(e,{HW:function(){return l},I5:function(){return p},q1:function(){return d}});var r=t(71921),o=t(28755),a=t(98656),u=["name"],c=["name"];function i(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,r)}return t}function s(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?i(Object(t),!0).forEach((function(e){(0,r.Z)(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}var l=(0,a.oM)({name:"columnPreference",initialState:{data:{}},reducers:{initAllColumnPreference:function(n,e){n.data=e.payload},setColumnPreference:function(n,e){var t=e.payload,r=t.name,a=(0,o.Z)(t,u);r&&(n.data[r]=a)},updateColumnPreference:function(n,e){var t=e.payload,r=t.name,a=(0,o.Z)(t,c);r&&(n.data[r]=s(s({},n.data[r]||{}),a))}}}),f=l.actions,p=f.setColumnPreference,d=(f.initAllColumnPreference,f.updateColumnPreference)},37736:function(n,e,t){t.d(e,{E3:function(){return o},It:function(){return p},Kf:function(){return l},ae:function(){return i},kY:function(){return f},uG:function(){return d},vQ:function(){return a},wL:function(){return s}});var r=t(98656),o={data:null,loading:!1,shouldRefresh:!1,error:null},a=function(n){return(0,r.oM)({name:n,initialState:o,reducers:{setData:function(n,e){n.data=e.payload},setShouldRefresh:function(n,e){n.shouldRefresh=!0},fetchStart:function(n){n.loading=!0,n.error=null,n.shouldRefresh=!1},fetchSuccess:function(n,e){n.data=e.payload,n.loading=!1,n.error=null,n.shouldRefresh=!1},fetchError:function(n,e){n.error=e.payload,n.loading=!1,n.shouldRefresh=!1}}})},u=function(n,e){var t,r=null===(t=e.payload)||void 0===t?void 0:t.name;return r||alert("Name is required in ".concat(JSON.stringify(e))),n[r]||(n[r]={}),r},c=function(n){return(0,r.oM)({name:n,initialState:{},reducers:{resetAllData:function(n){Object.keys(n).forEach((function(e){n[e]={data:null,loading:!1,error:null,shouldRefresh:!1}}))},refreshAllData:function(n){Object.keys(n).forEach((function(e){n[e].shouldRefresh=!0}))},resetData:function(n,e){n[u(n,e)]=null},setShouldRefresh:function(n,e){n[u(n,e)].shouldRefresh=!0},fetchSuccess:function(n,e){n[u(n,e)]={data:e.payload,loading:!1,error:null,shouldRefresh:!1}},fetchStart:function(n,e){var t=u(n,e);n[t].loading=!0,n[t].shouldRefresh=!1},fetchError:function(n,e){n[u(n,e)]={data:null,loading:!1,error:e.payload.error,shouldRefresh:!1}}}})},i=a("columnMeta"),s=c("baselineColumnStats"),l=c("filteredColumnStats"),f=c("cardinality"),p=a("rowData"),d=a("initSettings")},83611:function(n,e,t){t.d(e,{FV:function(){return O},KU:function(){return m},LJ:function(){return y},Lv:function(){return h},xU:function(){return g}});var r=t(69380),o=t(40679),a=t.n(o),u=t(98656),c=t(58243),i=t(99722),s=t.n(i),l=t(31032),f=t.n(l);function p(n,e){var t="undefined"!==typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=function(n,e){if(!n)return;if("string"===typeof n)return d(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);"Object"===t&&n.constructor&&(t=n.constructor.name);if("Map"===t||"Set"===t)return Array.from(n);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return d(n,e)}(n))||e&&n&&"number"===typeof n.length){t&&(n=t);var r=0,o=function(){};return{s:o,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,c=!1;return{s:function(){t=t.call(n)},n:function(){var n=t.next();return u=n.done,n},e:function(n){c=!0,a=n},f:function(){try{u||null==t.return||t.return()}finally{if(c)throw a}}}}function d(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var m=function(n){return"image_url"in n&&"bbox"in n&&"category_name"in n?[{name:"bbox_url",renderType:c.Je.IFRAME,baseUrl:"./viz-bbox.html",params:{image:"image_url",bboxes:'[{"bbox": bbox, "label": category_name}]',autorange:'"true"'}}]:[]},b=(0,u.oM)({name:"derivedColumns",initialState:[],reducers:{addDerivedColumn:function(n,e){n.push(e.payload)},removeDerivedColumn:function(n,e){var t=e.payload;return n.filter((function(n){return n.name!==t}))}}}),h=function(n){var e=n.baseUrl,t=n.params;return e+"?"+f().map(t,(function(n,e){return"".concat(e,"=").concat(encodeURIComponent(n))})).join("&")},v=function(){var n=(0,r.Z)(a().mark((function n(e){var t,r,o;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.expr,r=e.singleRowData,n.next=3,s()(t).evaluate(r);case 3:if("object"!==typeof(o=n.sent)){n.next=8;break}return n.abrupt("return",JSON.stringify(o));case 8:return n.abrupt("return",o);case 9:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),y=function(){var n=(0,r.Z)(a().mark((function n(e){var t,r,o,u,c;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.params,r=e.singleRowData,o=f().keys(t),u=f().map(o,(function(n){return v({expr:t[n],singleRowData:r})})),n.next=5,Promise.all(u);case 5:return c=n.sent,n.abrupt("return",f().zipObject(o,c));case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),g=function(){var n=(0,r.Z)(a().mark((function n(e){var t,r,o,u,c,i,s,l,f,d,m;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t=e.derivedColumns,r=e.rowData,o=p(r),n.prev=2,o.s();case 4:if((u=o.n()).done){n.next=29;break}c=u.value,i=p(t),n.prev=7,i.s();case 9:if((s=i.n()).done){n.next=19;break}return l=s.value,f=l.params,n.next=14,y({params:f,singleRowData:c});case 14:d=n.sent,m=h({baseUrl:l.baseUrl,params:d}),c[l.name]=m;case 17:n.next=9;break;case 19:n.next=24;break;case 21:n.prev=21,n.t0=n.catch(7),i.e(n.t0);case 24:return n.prev=24,i.f(),n.finish(24);case 27:n.next=4;break;case 29:n.next=34;break;case 31:n.prev=31,n.t1=n.catch(2),o.e(n.t1);case 34:return n.prev=34,o.f(),n.finish(34);case 37:return n.abrupt("return",r);case 38:case"end":return n.stop()}}),n,null,[[2,31,34,37],[7,21,24,27]])})));return function(e){return n.apply(this,arguments)}}(),w=b.actions,O=w.addDerivedColumn;w.removeDerivedColumn;e.ZP=b.reducer},98358:function(n,e,t){t.d(e,{Dy:function(){return v},ES:function(){return j},WH:function(){return x},ZJ:function(){return C},eP:function(){return y},pG:function(){return w},pk:function(){return k},tC:function(){return P},yx:function(){return g}});var r=t(69380),o=t(71921),a=t(9807),u=t(40679),c=t.n(u),i=t(98656),s=t(5490),l=t(33364),f=t.n(l),p=t(31032),d=t.n(p);function m(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,r)}return t}function b(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?m(Object(t),!0).forEach((function(e){(0,o.Z)(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}var h={treeData:[],viewingItemId:"",viewFolderAs:{},expandedItems:[]};function v(n,e){return n.startsWith("s3://")?"s3://"+f().join(n.slice(5),e):f().join(n,e)}function y(n){return n.startsWith("s3://")&&!n.slice(5).includes("/")?n:f().basename(n)}function g(n){if(n.startsWith("s3://")){var e=f().dirname(n.slice(5));return"."===e?".":"s3://"+e}return f().dirname(n)}function w(n,e){var t=e.split("/")[0],r=n.find((function(n){return n.id.split("/").pop()===t}));return e.includes("/")?w(r.children,e.slice(t.length+1)):r}function O(n){return"loading-".concat(n)}var S=(0,i.oM)({name:"folderBrowser",initialState:h,reducers:{setViewingItemId:function(n,e){n.viewingItemId=e.payload},resetAll:function(n){Object.keys(h).forEach((function(e){n[e]=h[e]}))},setExpandedItems:function(n,e){n.expandedItems=e.payload},toggleItemExpansion:function(n,e){var t=e.payload;n.expandedItems=n.expandedItems.includes(t)?n.expandedItems.filter((function(n){return n!==t})):[].concat((0,a.Z)(n.expandedItems),[t])},setViewFolderAs:function(n,e){var t=e.payload,r=t.id,o=t.viewAs;n.viewFolderAs[r]=o},updateChildrenSuccess:function(n,e){var t=e.payload,r=t.itemId,o=t.children.map((function(n){return b(b({id:v(r,n.name),label:n.name,secondaryLabel:n.isDir?"Folder":"File"},d().pick(n,["lastModified","isDir","size"])),{},{children:n.isDir?[{id:O(v(r,n.name)),label:"Loading..."}]:[]})}));""===r?n.treeData=o:w(n.treeData,r).children=o}}}),x=function(n){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(){var t=(0,r.Z)(c().mark((function t(o,a){var u,i,l,f,p;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f=function(){return(f=(0,r.Z)(c().mark((function e(){var t,r,a,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=v(i,n),r=u.settings.folderBrowserShowHiddenFiles,a=u.settings.folderBrowserListLimit,e.next=5,(0,s.Wu)({parentPath:t,showHidden:r,limit:a,dispatch:o});case 5:l=e.sent,o(S.actions.updateChildrenSuccess({itemId:n,children:l}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)},l=function(){return f.apply(this,arguments)},u=a(),i=u.settings.folderBrowserRootFolder){t.next=8;break}return t.abrupt("return");case 8:if(""!==n){t.next=13;break}return t.next=11,l();case 11:t.next=17;break;case 13:if(p=w(u.folderBrowser.treeData,n),!(e||p&&p.children&&1===p.children.length&&p.children[0].id===O(n))){t.next=17;break}return t.next=17,l();case 17:case"end":return t.stop()}}),t)})));return function(n,e){return t.apply(this,arguments)}}()},E=S.actions,C=E.setViewingItemId,k=E.setViewFolderAs,j=E.setExpandedItems,P=E.toggleItemExpansion;e.ZP=S.reducer},41208:function(n,e,t){t.d(e,{Mx:function(){return h},v5:function(){return g},wH:function(){return b}});var r=t(69380),o=t(71921),a=t(40679),u=t.n(a),c=t(37736),i=t(78356),s=t(5490),l=t(81476),f=t(31032),p=t.n(f);function d(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,r)}return t}function m(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?d(Object(t),!0).forEach((function(e){(0,o.Z)(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}var b="__y__label__value__",h=(0,c.vQ)("heatMap"),v=function(n){return{min:p().min(n),max:p().max(n),sum:p().sum(n)}},y=function(n){var e=p()(n).map("x").uniq().map(String).value(),t=p()(n).groupBy("y").map((function(n,e){return m(m({},p()(n).map((function(n){return[n.x,n]})).fromPairs().value()),{},(0,o.Z)({},b,e))})).value(),r=v(p().map(n,"cnt")),a=p().fromPairs(p().map(t,(function(n,e){var t=p()(n).values().map("cnt").value();return[n[b],v(t)]}))),u=p().fromPairs(p().map(e,(function(n,e){var r=p().map(t,(function(e){var t;return null===(t=e[n])||void 0===t?void 0:t.cnt}));return[n,v(r)]})));return{xLabels:e,rowData:p().map(t,(function(n){return m({rowTotal:a[n[b]].sum},n)})),xStats:u,yStats:a,allStats:r}},g=function(n){var e=n.heatmapXColumn,t=n.heatmapYColumn;return function(){var n=(0,r.Z)(u().mark((function n(r,o){var a,c,f,p,d,m,b,v;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=o().heatMap||{data:null,loading:!1,shouldRefresh:!1},c=a.data,f=a.loading,p=a.shouldRefresh,!c&&!f||p){n.next=3;break}return n.abrupt("return");case 3:return r(h.actions.fetchStart()),n.prev=4,d=(0,i.kA)(o()),m="\n    WITH filtered AS (\n          SELECT \n            ".concat((0,l.q)(e)," AS x, \n            ").concat((0,l.q)(t)," AS y\n          ").concat(d.from,"\n          ").concat(d.where,"\n      ) SELECT x, y, COUNT(*) AS cnt \n       FROM filtered\n       GROUP BY x, y\n      "),n.next=9,(0,s.Vn)({dispatch:r,key:"heatMap",query:m});case 9:b=n.sent,v=y(b),r(h.actions.fetchSuccess(v)),n.next=18;break;case 14:n.prev=14,n.t0=n.catch(4),console.error(n.t0),r(h.actions.fetchError(n.t0.message));case 18:case"end":return n.stop()}}),n,null,[[4,14]])})));return function(e,t){return n.apply(this,arguments)}}()}},45325:function(n,e,t){t.d(e,{J:function(){return h},S:function(){return b}});var r=t(67856),o=t(69380),a=t(40679),u=t.n(a),c=t(37736),i=t(78356),s=t(5490),l=t(31032),f=t.n(l),p=t(99064),d=t(81476),m=t(96975),b=(0,c.vQ)("histogram"),h=function(n){var e=n.histogramColumn,t=n.bin;return function(){var n=(0,o.Z)(u().mark((function n(o,a){var l,h,v,y,g,w,O,S,x,E,C,k;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(l=a().histogram||c.E3,h=l.data,v=l.loading,y=l.shouldRefresh,!h&&!v||y){n.next=3;break}return n.abrupt("return");case 3:return g=a().settings.histogramBreakdownColumn,o(b.actions.fetchStart()),n.prev=5,w=t.min,O=t.step,S=t.round_to,x=(0,i.kA)(a()),E="\n   WITH filtered AS (\n      SELECT \n        ".concat((0,d.q)(e)," AS value, \n        ").concat((0,d.q)(g)," AS breakdown\n      ").concat(x.from,"\n      ").concat(x.where," AND value IS NOT NULL  \n    )\n    SELECT breakdown, FLOOR((value - ").concat(w,") / ").concat(O,") AS binIdx, \n        COUNT(*) AS cnt\n    FROM filtered\n    GROUP BY 1, 2\n    ORDER BY 1, 2\n "),n.next=11,(0,s.Vn)({dispatch:o,key:"histogram",query:E});case 11:C=n.sent,k=f()(C).groupBy("breakdown").toPairs().map((function(n){var t=(0,r.Z)(n,2),o=t[0],a=t[1],u=(0,p._)({min:w,step:O,round_to:S,cntValues:a}),c=f().map(u,"value"),i=f().map(u,"cnt"),s=f().map(u,(function(n){var t=["".concat((0,d.q)(e)," >= ").concat(n.binMin),"".concat((0,d.q)(e)," < ").concat(n.binMax)],r=(0,m.XE)(g)?[]:["".concat((0,d.q)(g)," = '").concat(o,"'")];return{condExpr:[].concat(t,r).join(" AND ")}}));return{name:o,x:c,y:i,customdata:s}})).value(),o(b.actions.fetchSuccess(k)),n.next=20;break;case 16:n.prev=16,n.t0=n.catch(5),console.error(n.t0),o(b.actions.fetchError(n.t0.message));case 20:case"end":return n.stop()}}),n,null,[[5,16]])})));return function(e,t){return n.apply(this,arguments)}}()}},92633:function(n,e,t){t.d(e,{V:function(){return c}});var r=t(67856),o=t(98656),a={mode:(0,t(96975).X0)("theme")||"dark",boxPlotBreakdownColumn:null},u=(0,o.oM)({name:"settings",initialState:a,reducers:{updateSettings:function(n,e){var t=e.payload||{};Object.entries(t).forEach((function(e){var t=(0,r.Z)(e,2),o=t[0],a=t[1];n[o]=a,"mode"===o&&localStorage.setItem("theme",a)}))}}}),c=u.actions.updateSettings;e.Z=u.reducer},33311:function(n,e,t){t.d(e,{M:function(){return c}});var r=t(67856),o=t(98656),a=t(82751),u=(0,o.oM)({name:"sql",initialState:{},reducers:{updateSqlRecord:function(n,e){var t=e.payload,o=t.key,u=t.records;o in n||(n[o]={}),Object.entries(u).forEach((function(e){var t=(0,r.Z)(e,2),u=t[0],c=t[1];if("query"===u){try{n[o].query=(0,a.WU)(c,{language:"duckdb"})+"\n"}catch(i){n[o].query=c+"\n",console.warn(i)}n[o].lastUpdated=Date.now()}else n[o][u]=c}))}}}),c=u.actions.updateSqlRecord;e.Z=u.reducer},56800:function(n,e,t){t.d(e,{CF:function(){return a},PE:function(){return u}});var r=(0,t(98656).oM)({name:"toast",initialState:{open:!1,message:"",severity:"info",autoHideDuration:6e3},reducers:{showToast:function(n,e){var t=e.payload,r=t.message,o=t.severity,a=void 0===o?"info":o,u=t.autoHideDuration,c=void 0===u?6e3:u;n.open=!0,n.message=r,n.severity=a,n.autoHideDuration=c},hideToast:function(n){n.open=!1}}}),o=r.actions,a=o.showToast,u=o.hideToast;e.ZP=r.reducer},58055:function(n,e,t){t.d(e,{CE:function(){return h},Ik:function(){return s},O1:function(){return f},Rw:function(){return d},W_:function(){return b},d2:function(){return m},dZ:function(){return p},gU:function(){return v},jY:function(){return l},nn:function(){return c}});var r=t(71921);function o(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,r)}return t}function a(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?o(Object(t),!0).forEach((function(e){(0,r.Z)(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}var u=(0,t(98656).oM)({name:"viewing",initialState:{justClickedColumn:null,justClickedRow:null,pagination:{pageSize:10,pageNumber:0},rowDataSource:null,sampleCondition:"True",heatmapColumnSort:{},visibleColumns:[]},reducers:{setJustClickedColumn:function(n,e){n.justClickedColumn=e.payload},setJustClickedRow:function(n,e){n.justClickedRow=e.payload},updatePagination:function(n,e){n.pagination=a(a({},n.pagination),e.payload)},updateCountBaseline:function(n,e){n.pagination.countBaseline=e.payload},updateCountFiltered:function(n,e){n.pagination.countFiltered=e.payload},setRowDataSource:function(n,e){n.rowDataSource=e.payload},setSampleCondition:function(n,e){n.sampleCondition=e.payload},toggleHeatmapColumnSort:function(n,e){var t=e.payload,r=["desc","asc","none"],o=n.heatmapColumnSort,a=o.byRow,u=o.order;n.heatmapColumnSort=a===t?{byRow:t,order:r[(r.indexOf(u)+1)%r.length]}:{byRow:t,order:r[0]}},setFreeFormQuery:function(n,e){n.freeFormQuery=e.payload},setVisibleColumns:function(n,e){n.visibleColumns=e.payload}}}),c=function(n){var e=n.dispatch,t=n.columnName,r=u.actions.setJustClickedColumn;e(r(t)),setTimeout((function(){e(r(null))}),1e3)},i=u.actions,s=i.updatePagination,l=i.setJustClickedRow,f=i.setRowDataSource,p=i.setSampleCondition,d=i.toggleHeatmapColumnSort,m=i.setFreeFormQuery,b=i.updateCountBaseline,h=i.updateCountFiltered,v=i.setVisibleColumns;e.ZP=u.reducer},5490:function(n,e,t){t.d(e,{PD:function(){return y},Vn:function(){return h},Wu:function(){return g},dh:function(){return w},qG:function(){return v}});var r=t(9807),o=t(71921),a=t(69380),u=t(40679),c=t.n(u),i=t(31032),s=t.n(i),l=t(33311),f=t(38899),p=t(56800);function d(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,r)}return t}function m(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?d(Object(t),!0).forEach((function(e){(0,o.Z)(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}var b=function(){var n=(0,a.Z)(c().mark((function n(e){var t,r,o,a,u,i,s,l;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.url,r=e.data,o=void 0===r?{}:r,a=e.dispatch,u=void 0===a?null:a,n.next=3,fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});case 3:if((i=n.sent).ok){n.next=8;break}throw s="Failed to fetch data from server",u&&u((0,p.CF)({message:s,severity:"error"})),new Error(s);case 8:return n.next=10,i.json();case 10:return l=n.sent,n.abrupt("return",l);case 12:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),h=function(){var n=(0,a.Z)(c().mark((function n(e){var t,o,a,u,i,d,h;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.dispatch,o=e.key,a=e.query,u=e.transformResult,i=void 0===u?"listOfDicts":u,t((0,l.M)({key:o,records:{query:a,status:"running",data:null,runtime:null}})),n.prev=2,n.next=5,b({url:"".concat(f.vU,"/query"),data:{query:a},dispatch:t});case 5:if("error"!==(d=n.sent).status){n.next=11;break}throw console.error(d.error),t((0,p.CF)({message:d.error||"An error occurred while running the query",severity:"error"})),t((0,l.M)({key:o,records:{error:d.error||"An error occurred while running the query",status:"error"}})),new Error(d.error||"An error occurred while running the query");case 11:t((0,l.M)({key:o,records:{runtime:d.runtime,error:d.error,status:d.status,data:d.rows.map((function(n){return s().zipObject(d.column_names,n)}))}})),n.t0=i,n.next="listOfDicts"===n.t0?15:"dictOfLists"===n.t0?17:"none"===n.t0?18:19;break;case 15:return h=d.rows.map((function(n,e){return m(m({},s().zipObject(d.column_names,n)),{},{rowIndex:e})})),n.abrupt("return",h);case 17:return n.abrupt("return",s().zipObject(d.column_names,s().zip.apply(s(),(0,r.Z)(d.rows))));case 18:return n.abrupt("return",s().pick(d,["column_names","rows"]));case 19:throw new Error("Invalid way of transforming result: ".concat(i));case 20:n.next=27;break;case 22:throw n.prev=22,n.t1=n.catch(2),console.error(n.t1),t((0,l.M)({key:o,records:{error:n.t1.message,status:"error"}})),n.t1;case 27:case"end":return n.stop()}}),n,null,[[2,22]])})));return function(e){return n.apply(this,arguments)}}(),v=function(){var n=(0,a.Z)(c().mark((function n(e){var t,r,o,a;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.dispatch,r=e.dataFile,o=e.sqlKey,a="WITH meta AS (\n    SELECT\n        path_in_schema AS column_name,\n        SUM(num_values) AS cntAll,\n        SUM(stats_null_count) AS cntNull,\n        MIN(stats_min_value) AS min,\n        MAX(stats_max_value) AS max\n    FROM parquet_metadata('".concat(r,"')\n    GROUP BY path_in_schema\n  )\n  SELECT column_name, column_type, cntAll, cntNull, min, max\n  FROM (DESCRIBE SELECT * FROM read_parquet ('").concat(r,"'))\n      LEFT JOIN meta USING (column_name)\n  "),n.next=4,h({dispatch:t,key:o,query:a});case 4:return n.abrupt("return",n.sent);case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),y=function(){var n=(0,a.Z)(c().mark((function n(e){var t,r,o,a;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.dispatch,r=e.dataFile,o=e.sqlKey,a="SELECT * FROM read_csv ('".concat(r,"') LIMIT 10"),n.next=4,h({dispatch:t,key:o,query:a});case 4:return n.abrupt("return",n.sent);case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),g=function(){var n=(0,a.Z)(c().mark((function n(e){var t,r,o,a,u,i,s,l,d;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.parentPath,r=e.showHidden,o=void 0!==r&&r,a=e.limit,u=void 0===a?100:a,i=e.dispatch,n.next=3,fetch("".concat(f.vU,"/ls?path=").concat(encodeURIComponent(t),"&show_hidden=").concat(o,"&limit=").concat(u));case 3:if((s=n.sent).ok){n.next=8;break}throw l="Failed to fetch directory listing",i&&i((0,p.CF)({message:l,severity:"error"})),new Error(l);case 8:return n.next=10,s.json();case 10:return d=n.sent,n.abrupt("return",d);case 12:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),w=function(){var n=(0,a.Z)(c().mark((function n(e){var t,r;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.urls,!s().every(t,(function(n){return(0,f.$4)(n)}))){n.next=8;break}return n.next=4,b({url:"".concat(f.vU,"/s3-proxy"),data:{urls:t}});case 4:return r=n.sent,n.abrupt("return",r);case 8:return n.abrupt("return",t);case 9:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},96975:function(n,e,t){t.d(e,{$x:function(){return i},X0:function(){return c},XE:function(){return a},kX:function(){return u}});var r=t(31032),o=t.n(r),a=function(n){return null===n||void 0===n},u=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];if(e.length>0){var r=e.find((function(n){return!a(n)}));return a(r)?null:r}throw new Error("No arguments provided to coalesce")},c=function(n){return localStorage.getItem(n)},i=function(n,e){return o().isEqual(o().sortBy(n),o().sortBy(e))}},99064:function(n,e,t){t.d(e,{_:function(){return c}});var r=t(71921),o=t(31032),a=t.n(o);function u(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,r)}return t}var c=function(n){var e,t=n.min,c=n.step,i=n.round_to,s=n.cntValues,l=null===(e=a().maxBy(s,"binIdx"))||void 0===e?void 0:e.binIdx,f=a().fromPairs(a().map(s,(function(n){return[n.binIdx,n]})));return a().range(l+1).map((function(n){var e=(0,o.round)(n*c+t,i),a=(0,o.round)(e+c,i);return function(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?u(Object(t),!0).forEach((function(e){(0,r.Z)(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):u(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}({binIdx:n,value:"[".concat(e,", ").concat(a,")"),binMin:e,binMax:a},f[n]||{})}))}},81476:function(n,e,t){t.d(e,{M:function(){return u},q:function(){return c}});var r=t(96975),o=t(31032),a=t.n(o),u=function n(e){if((0,r.XE)(e))return"NULL";if("string"===typeof e)return"'".concat(e,"'");if("number"===typeof e)return"".concat(e);if("boolean"===typeof e)return e?"TRUE":"FALSE";if(Array.isArray(e))return"("+a()(e).map(n).join(",")+")";throw new Error("Unknown value type: ".concat(typeof e))},c=function n(e){if((0,r.XE)(e))return"NULL";if("string"!==typeof e)throw new Error("Expecting a string for name, but got ".concat(typeof e,": ").concat(e));if(""===(e=e.trim()))throw new Error("Empty name");return/^[a-zA-Z0-9_]+$/.test(e)?e:e.includes(".")?e.split(".").map(n).join("."):'"'.concat(e,'"')}},73139:function(n,e,t){t.d(e,{f:function(){return i}});var r=t(31032),o=t.n(r),a=t(96975),u=t(81476),c=function(n,e,t){switch(t){case"include":return e?"".concat(e," OR ").concat((0,u.q)(n)," IS NULL"):null;case"exclude":return e?"".concat(e):"".concat((0,u.q)(n)," IS NOT NULL");case"only":return"".concat((0,u.q)(n)," IS NULL");case"N/A":return e;default:throw new Error("Unknown null filter: ".concat(t))}},i=function(n,e){var t=e||{},r=t.filterType,i=t.null;if((0,a.XE)(i))throw new Error("Null filter is required for ".concat(n));switch(r){case"myText":return function(n,e){var t=e||{},r=t.contains,o=t.null;if((0,a.XE)(r)||""===r)return c(n,null,o);var i="CAST(".concat((0,u.q)(n)," AS VARCHAR) LIKE '%").concat(r,"%'");return c(n,i,o)}(n,e);case"myEnum":return function(n,e){var t=e||{},r=t.including,o=t.null;if((0,a.XE)(r)||0===r.length)return c(n,null,o);var i="".concat((0,u.q)(n)," IN ").concat((0,u.M)(r));return c(n,i,o)}(n,e);case"myRange":return function(n,e){var t=e||{},r=t.range,i=t.null;if((0,a.XE)(r))return c(n,null,i);if(!Array.isArray(r)||2!==r.length||r.some((function(n){return!o().isNumber(n)})))throw new Error("Invalid range: ".concat(r));var s="".concat((0,u.q)(n)," BETWEEN ").concat(r[0]," AND ").concat(r[1]);return c(n,s,i)}(n,e);default:throw new Error("Unknown filter type: ".concat(r))}}},78356:function(n,e,t){t.d(e,{Gg:function(){return c},kA:function(){return s}});var r=t(31032),o=t.n(r),a=t(73139),u=t(81476),c=function(n){return o().map(n,(function(n,e){try{return null===n?null:(0,a.f)(e,n)}catch(t){return console.error("Error parsing filter for column ".concat(e,":"),t),null}})).filter(Boolean).map((function(n){return"(".concat(n,")")})).join(" AND ")},i=function(n){var e=n.filters,t=n.baselineFilters;return[c(e),c(t)].filter(Boolean).join(" AND ")||"True"},s=function(n){var e=n.dataFile.tableExpr,t=n.agColDefs,r=t.filters,o=t.baselineFilters,a=n.viewing.pagination,c=a.pageSize,s=a.pageNumber,l=n.agColDefs.sorting,f=0===l.length?"":"ORDER BY ".concat(l.map((function(n){return"".concat((0,u.q)(n.field)," ").concat(n.order.toUpperCase())})).join(", "));return{from:"FROM ".concat(e),where:"WHERE ".concat(i({filters:r,baselineFilters:o})),order:f,pagination:"LIMIT ".concat(c," OFFSET ").concat(s*c)}}},38899:function(n,e,t){t.d(e,{$4:function(){return o},k9:function(){return a},qm:function(){return u},vU:function(){return r}});var r="./api",o=function(n){var e=function(n){return n&&n.includes("://")?n.split("://")[0].toLowerCase():""}(n);return!["http","https",""].includes(e)},a=function(n){return o(n)?"".concat(r,"/s3-proxy?url=").concat(encodeURIComponent(n)):n},u=function(n){return"".concat(r,"/get-file?path=").concat(encodeURIComponent(n))}}}]);
//# sourceMappingURL=980-54a3aea34e710c8d.js.map